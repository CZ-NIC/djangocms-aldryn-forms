{% extends "admin/change_form.html" %}

{% block extrastyle %}
    {{ block.super }}
    <style>
        .examples pre {
            background-color: #fff;
            border: solid #00bbff 1px;
            padding: 1em;
        }
        .examples pre code {
            color:#004d69;
        }
        .see-more {
            margin-bottom: 2em;
        }
    </style>
{% endblock %}

{% block content %}
    {{ block.super }}

<h4>Transform example</h4>

<div class="examples">

<pre><code>[
    {"dest": "roid", "value": "1234650"},
    {
        "dest": "first_name",
        "src": ".form_data[] | select(.label==\"Name\").value",
        "match": "(.+)\\s+\\S+$"
    },
    {
        "dest": "last_name",
        "src": ".form_data[] | select(.label==\"Name\").value",
        "match": ".+\\s+(\\S+)$"
    },
    {
        "dest": "email",
        "src": ".form_data[] | select(.label==\"Email\").value"
    },
    {
        "dest": "phone",
        "src": ".form_data[] | select(.label==\"Phone\").value"
    },
    {
        "dest": "company",
        "src": ".form_data[] | select(.label==\"Company\").value"
    },
    {
        "dest": "address",
        "src": [
            ".form_data[] | select(.name==\"street\").value",
            ".form_data[] | select(.name==\"city\").value"
        ],
        "sep": "; "
    },
    {
        "dest": "ip",
        "src": ".ipv4",
        "match": ["(\\d+).+(\\d+).+(\\d+).+(\\d+)", "S", "."]
    }
    {
        "dest": "lead_source",
        "src": ".hostname"
    }
]</code></pre>
<div class="see-more">For more see <a href="https://jqlang.github.io/jq/manual/" target="_top">./jq Manual</a>.</div>

<h4>Source data example</h4>

<pre><code>{
    "hostname": "example.com",
    "name": "The form name",
    "language": "en",
    "sent_at": "2025-03-03T02:00:48.439766Z",
    "ipv4": "127\n0\n0\n0\n1",
    "form_recipients": [
        {
            "name": "Dave",
            "email": "dave@dwarf.red"
        }
    ],
    "form_data": [
        {
            "name": "name",
            "label": "Name",
            "field_occurrence": 1,
            "value": "Arnold Rimmer"
        },
        {
            "name": "email",
            "label": "Email",
            "field_occurrence": 1,
            "value": "arnold@dwarf.red"
        },
        {
            "name": "street",
            "label": "Street and number",
            "field_occurrence": 1,
            "value": "Upper Deck 42"
        },
        {
            "name": "city",
            "label": "City",
            "field_occurrence": 1,
            "value": "Deep space"
        },

    ]
}</code></pre>
<div class="see-more">For more see <a href="/api/v1/" target="_top">Api Root</a>.</div>

<h4>Result of examples</h4>

<pre><code>{
    "roid": "1234650",
    "first_name": "Arnold",
    "last_name": "Rimmer",
    "email": "arnold@dwarf.red",
    "address": "Upper Deck 42; Deep space",
    "lead_source": "example.com",
    "ip": "127.0.0.1"
}</code></pre>

</div>

{% endblock %}
